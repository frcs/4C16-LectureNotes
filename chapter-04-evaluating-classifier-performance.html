<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.33">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>4&nbsp; Evaluating Classifier Performance – 4C16 - Deep Learning and its Applications</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./chapter-05-deep-feedforward-networks.html" rel="next">
<link href="./chapter-03-classic-classifiers.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-ea385d0e468b0dd5ea5bf0780b1290d9.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-8b7c2752407ea3c5e4b18459525f0011.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="style.css">
</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./chapter-01-linear-regression.html">Introduction to Machine Learning</a></li><li class="breadcrumb-item"><a href="./chapter-04-evaluating-classifier-performance.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Evaluating Classifier Performance</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">4C16 - Deep Learning and its Applications</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Module Descriptor</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter-00-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Introduction to Machine Learning</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter-01-linear-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Linear Regression and Least Squares</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter-02-logistic-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Logistic Regression: From Lines to Probabilities</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter-03-classic-classifiers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">A Tour of Classic Classifiers</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter-04-evaluating-classifier-performance.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Evaluating Classifier Performance</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Foundations of Deep Neural Networks</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter-05-deep-feedforward-networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Feedforward Neural Networks</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter-06-convolutional-neural-networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Convolutional Neural Networks</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Modern Architectures and Techniques</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter-07-advances-in-network-architectures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Advances in Network Architectures</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter-08-recurrent-neural-networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Recurrent Neural Networks</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter-09-generative-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">An Introduction to Generative Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter-10-transformers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Attention Mechanism and Transformers</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter-11-LLMs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Large Language Models</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./note-01-error-loss-likelihood.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Relationship between Error, Loss Function and Maximum Likelihood</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./note-02-universal-approximation-theorem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Universal Approximation Theorem</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./note-03-l1-induces-sparsity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Why Does <span class="math inline">L_1</span> Regularisation Induce Sparsity?</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./note-04-kernel-trick.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Kernel Trick</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./note-05-He-initialisation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">He Initialisation</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#metrics-for-binary-classification" id="toc-metrics-for-binary-classification" class="nav-link active" data-scroll-target="#metrics-for-binary-classification"><span class="header-section-number">4.1</span> Metrics for Binary Classification</a>
  <ul class="collapse">
  <li><a href="#the-confusion-matrix" id="toc-the-confusion-matrix" class="nav-link" data-scroll-target="#the-confusion-matrix"><span class="header-section-number">4.1.1</span> The Confusion Matrix</a></li>
  <li><a href="#accuracy" id="toc-accuracy" class="nav-link" data-scroll-target="#accuracy"><span class="header-section-number">4.1.2</span> Accuracy</a></li>
  <li><a href="#precision-and-recall" id="toc-precision-and-recall" class="nav-link" data-scroll-target="#precision-and-recall"><span class="header-section-number">4.1.3</span> Precision and Recall</a></li>
  <li><a href="#the-f1-score" id="toc-the-f1-score" class="nav-link" data-scroll-target="#the-f1-score"><span class="header-section-number">4.1.4</span> The F1 Score</a></li>
  <li><a href="#the-importance-of-using-multiple-metrics" id="toc-the-importance-of-using-multiple-metrics" class="nav-link" data-scroll-target="#the-importance-of-using-multiple-metrics"><span class="header-section-number">4.1.5</span> The Importance of Using Multiple Metrics</a></li>
  </ul></li>
  <li><a href="#visualising-performance-the-roc-curve" id="toc-visualising-performance-the-roc-curve" class="nav-link" data-scroll-target="#visualising-performance-the-roc-curve"><span class="header-section-number">4.2</span> Visualising Performance: The ROC Curve</a>
  <ul class="collapse">
  <li><a href="#area-under-the-curve-auc" id="toc-area-under-the-curve-auc" class="nav-link" data-scroll-target="#area-under-the-curve-auc"><span class="header-section-number">4.2.1</span> Area Under the Curve (AUC)</a></li>
  <li><a href="#average-precision" id="toc-average-precision" class="nav-link" data-scroll-target="#average-precision"><span class="header-section-number">4.2.2</span> Average Precision</a></li>
  </ul></li>
  <li><a href="#metrics-for-multiclass-classification" id="toc-metrics-for-multiclass-classification" class="nav-link" data-scroll-target="#metrics-for-multiclass-classification"><span class="header-section-number">4.3</span> Metrics for Multiclass Classification</a></li>
  <li><a href="#the-three-essential-datasets-training-validation-and-testing" id="toc-the-three-essential-datasets-training-validation-and-testing" class="nav-link" data-scroll-target="#the-three-essential-datasets-training-validation-and-testing"><span class="header-section-number">4.4</span> The Three Essential Datasets: Training, Validation, and Testing</a></li>
  <li><a href="#takeaways" id="toc-takeaways" class="nav-link" data-scroll-target="#takeaways"><span class="header-section-number">4.5</span> Takeaways</a></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises">Exercises</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./chapter-01-linear-regression.html">Introduction to Machine Learning</a></li><li class="breadcrumb-item"><a href="./chapter-04-evaluating-classifier-performance.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Evaluating Classifier Performance</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Evaluating Classifier Performance</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In the preceding chapters, we have explored a variety of classification algorithms, including Logistic Regression, Support Vector Machines (SVMs), Decision Trees, and <span class="math inline">k</span>-Nearest Neighbours (<span class="math inline">k</span>-NN). We have seen how each of these models learns to draw a decision boundary to separate different classes in our feature space.</p>
<div id="fig-dataset04" class="quarto-float quarto-figure quarto-figure-left anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-dataset04-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/compare-classifiers-decision-boundary-1.svg" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-dataset04-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.1: Classification results for some popular classifiers on a sample dataset.
</figcaption>
</figure>
</div>
<p>Looking at these plots gives us a qualitative sense of how the classifiers behave, but it is not enough. To build effective machine learning systems, we need to move beyond visual intuition. We need a rigorous, quantitative way to answer critical questions:</p>
<ul>
<li>How do we measure the performance of a single classifier?</li>
<li>How do we compare the performance of different classifiers?</li>
<li>How do we select the best model for our specific problem?</li>
</ul>
<p>To do this, we need to establish a set of standard, objective <strong>evaluation metrics</strong> that allow us to score and compare models in a consistent and meaningful way.</p>
<section id="metrics-for-binary-classification" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="metrics-for-binary-classification"><span class="header-section-number">4.1</span> Metrics for Binary Classification</h2>
<p>Let us begin with the most common scenario: binary classification. Here, the outcome belongs to one of two classes, which we typically label as <strong>positive</strong> (class 1) and <strong>negative</strong> (class 0). For any prediction our classifier makes, there are four possible outcomes:</p>
<ul>
<li><strong>True Positive (TP)</strong>: The model correctly predicts the positive class. (Predicts 1, and the true class is 1).</li>
<li><strong>True Negative (TN)</strong>: The model correctly predicts the negative class. (Predicts 0, and the true class is 0).</li>
<li><strong>False Positive (FP)</strong>: The model incorrectly predicts the positive class. (Predicts 1, but the true class is 0). This is also known as a <strong>Type I error</strong>.</li>
<li><strong>False Negative (FN)</strong>: The model incorrectly predicts the negative class. (Predicts 0, but the true class is 1). This is also known as a <strong>Type II error</strong>.</li>
</ul>
<p>These four outcomes form the basis of nearly all binary classification metrics.</p>
<section id="the-confusion-matrix" class="level3" data-number="4.1.1">
<h3 data-number="4.1.1" class="anchored" data-anchor-id="the-confusion-matrix"><span class="header-section-number">4.1.1</span> The Confusion Matrix</h3>
<p>The most fundamental tool for summarising a classifier’s performance is the <strong>confusion matrix</strong>. It is a simple table that lays out the counts of TP, TN, FP, and FN, providing a complete picture of the model’s predictions versus the actual ground truth.</p>
<div id="tbl:CM" class="columns">
<div class="column" style="width:70%;">
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: center;">Actual: Negative (0)</th>
<th style="text-align: center;">Actual: Positive (1)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Predicted: 0</td>
<td style="text-align: center;">TN</td>
<td style="text-align: center;">FN</td>
</tr>
<tr class="even">
<td style="text-align: left;">Predicted: 1</td>
<td style="text-align: center;">FP</td>
<td style="text-align: center;">TP</td>
</tr>
</tbody>
</table>
<p>The structure of a confusion matrix.</p>
</div>
</div>
<p>For example, the confusion matrices for the classifiers shown in <a href="#fig-dataset04" class="quarto-xref">Figure&nbsp;<span>4.1</span></a> are as follows:</p>
<div id="tbl-panel" class="quarto-layout-panel anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-panel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;4.1: Confusion Matrices for the classifiers shown in <a href="#fig-dataset04" class="quarto-xref">Figure&nbsp;<span>4.1</span></a>
</figcaption>
<div aria-describedby="tbl-panel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="tbl-panel" style="flex-basis: 50.0%;justify-content: center;">
<div id="tbl-CM-RBFSVM" class="quarto-float quarto-figure quarto-figure-left anchored">
<figure class="quarto-float quarto-subfloat-tbl figure">
<figcaption class="quarto-float-caption-top quarto-subfloat-caption quarto-subfloat-tbl" id="tbl-CM-RBFSVM-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) RBF SVM classifier.
</figcaption>
<div aria-describedby="tbl-CM-RBFSVM-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Actual: 0</th>
<th style="text-align: left;">Actual: 1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Predicted: 0</td>
<td style="text-align: left;">TN=162</td>
<td style="text-align: left;">FN=25</td>
</tr>
<tr class="even">
<td style="text-align: left;">Predicted: 1</td>
<td style="text-align: left;">FP=17</td>
<td style="text-align: left;">TP=196</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</div>
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="tbl-panel" style="flex-basis: 50.0%;justify-content: center;">
<div id="tbl-CM-DT" class="quarto-float quarto-figure quarto-figure-left anchored">
<figure class="quarto-float quarto-subfloat-tbl figure">
<figcaption class="quarto-float-caption-top quarto-subfloat-caption quarto-subfloat-tbl" id="tbl-CM-DT-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Decision Tree classifier.
</figcaption>
<div aria-describedby="tbl-CM-DT-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: center;">Actual: 0</th>
<th style="text-align: center;">Actual: 1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Predicted: 0</td>
<td style="text-align: center;">TN=170</td>
<td style="text-align: center;">FN=17</td>
</tr>
<tr class="even">
<td style="text-align: left;">Predicted: 1</td>
<td style="text-align: center;">FP=29</td>
<td style="text-align: center;">TP=184</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
<p>While the confusion matrix is comprehensive, it is often useful to distill these counts into a few key summary statistics.</p>
</section>
<section id="accuracy" class="level3" data-number="4.1.2">
<h3 data-number="4.1.2" class="anchored" data-anchor-id="accuracy"><span class="header-section-number">4.1.2</span> Accuracy</h3>
<p><strong>Accuracy</strong> is perhaps the most intuitive metric. It measures the overall fraction of predictions that the classifier got right.</p>
<p><span class="math display">
\mathrm{Accuracy} = \frac{\mathrm{TP} + \mathrm{TN}}{\mathrm{TP} + \mathrm{TN} + \mathrm{FP} + \mathrm{FN}} = \frac{\text{Number of correct predictions}}{\text{Total number of predictions}}
</span></p>
<p>While simple, accuracy can be misleading, especially when dealing with <strong>imbalanced datasets</strong> (where one class is much more frequent than the other). For example, if a disease affects only 1% of the population, a model that always predicts “no disease” will have 99% accuracy, but it will be completely useless for its intended purpose.</p>
</section>
<section id="precision-and-recall" class="level3" data-number="4.1.3">
<h3 data-number="4.1.3" class="anchored" data-anchor-id="precision-and-recall"><span class="header-section-number">4.1.3</span> Precision and Recall</h3>
<p>To get a more nuanced view, we often turn to two complementary metrics: precision and recall.</p>
<p><strong>Recall</strong>, also known as <strong>Sensitivity</strong> or the <strong>True Positive Rate (TPR)</strong>, answers the question: <em>Of all the actual positive examples, what fraction did we correctly identify?</em></p>
<p><span class="math display">
\mathrm{Recall} = \frac{\mathrm{TP}}{\mathrm{TP} + \mathrm{FN}} = p(\hat{y}=1 | y=1)
</span></p>
<p>High recall is crucial in applications where failing to detect a positive case has severe consequences (e.g., medical screening, fraud detection). We want to minimise false negatives.</p>
<p><strong>Precision</strong> answers the question: <em>Of all the examples we predicted as positive, what fraction were actually positive?</em></p>
<p><span class="math display">
\mathrm{Precision} = \frac{\mathrm{TP}}{\mathrm{TP} + \mathrm{FP}} = p(y=1 | \hat{y}=1)
</span></p>
<p>High precision is important when the cost of a false positive is high (e.g., a spam filter marking an important email as spam).</p>
<p>There is often a trade-off between precision and recall. A model that is very aggressive in predicting positives will have high recall but may have low precision. A model that is very conservative will have high precision but may have low recall.</p>
</section>
<section id="the-f1-score" class="level3" data-number="4.1.4">
<h3 data-number="4.1.4" class="anchored" data-anchor-id="the-f1-score"><span class="header-section-number">4.1.4</span> The F1 Score</h3>
<p>The <strong>F1 score</strong> provides a way to combine precision and recall into a single number. It is the harmonic mean of the two, which tends to be closer to the smaller of the two values. It is high only when both precision and recall are high.</p>
<p><span class="math display">
F_{1} = 2 \cdot \frac{\mathrm{Precision} \cdot \mathrm{Recall}}{\mathrm{Precision} + \mathrm{Recall}} = \frac{2\mathrm{TP}}{2\mathrm{TP} + \mathrm{FP} + \mathrm{FN}}
</span></p>
</section>
<section id="the-importance-of-using-multiple-metrics" class="level3" data-number="4.1.5">
<h3 data-number="4.1.5" class="anchored" data-anchor-id="the-importance-of-using-multiple-metrics"><span class="header-section-number">4.1.5</span> The Importance of Using Multiple Metrics</h3>
<p>It is critical to understand that a single metric rarely tells the whole story. Relying on just one can be dangerously misleading, as a classifier can easily be designed to perform perfectly on one metric while being terrible in practice.</p>
<div id="callout-example-dummydataset" class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Example
</div>
</div>
<div class="callout-body-container callout-body">
<p>Consider a dataset with 100 examples: 15 are positive (class 1) and 85 are negative (class 0).</p>
<ul>
<li><p><strong>Classifier A</strong> always predicts positive (1). Its confusion matrix is: TN=0, FN=0, FP=85, TP=15. Its recall is <span class="math inline">15/(15+0) = 100\%</span>, which sounds perfect! However, its precision is a dismal <span class="math inline">15/(15+85) = 15\%</span>.</p></li>
<li><p><strong>Classifier B</strong> always predicts negative (0). Its confusion matrix is: TN=85, FN=15, FP=0, TP=0. Its accuracy is <span class="math inline">(85+0)/100 = 85\%</span>, which seems quite good. But its recall is <span class="math inline">0/(0+15) = 0\%</span>. It fails to find any of the positive cases.</p></li>
</ul>
<p>Both classifiers are useless, but you need at least two metrics (e.g., precision and recall, or recall and accuracy) to see the full picture.</p>
<p><strong>Conclusion: Never evaluate a classifier with a single metric in isolation.</strong></p>
</div>
</div>
</section>
</section>
<section id="visualising-performance-the-roc-curve" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="visualising-performance-the-roc-curve"><span class="header-section-number">4.2</span> Visualising Performance: The ROC Curve</h2>
<p>Many classifiers, like logistic regression, do not output a hard 0 or 1 label directly. Instead, they produce a score or probability. We then apply a <strong>threshold</strong> to this score to make the final classification (e.g., predict 1 if score &gt; 0.5).</p>
<p>Changing this threshold allows us to trade off between the True Positive Rate (Recall) and the <strong>False Positive Rate (FPR)</strong>, which is the proportion of negatives that are incorrectly labelled as positive.</p>
<p><span class="math display">
\mathrm{FPR} = \frac{\mathrm{FP}}{\mathrm{FP} + \mathrm{TN}} = p(\hat{y}=1 | y=0)
</span></p>
<p>The <strong>Receiver Operating Characteristic (ROC) curve</strong> is a powerful tool that visualises this trade-off. It is created by plotting the TPR (y-axis) against the FPR (x-axis) for every possible threshold value.</p>
<div id="fig-roc-curve-example" class="quarto-float quarto-figure quarto-figure-left anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-roc-curve-example-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/ROC-1.svg" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-roc-curve-example-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.2: An example of Receiving Operating Characteristic (ROC) curves for four different classifiers.
</figcaption>
</figure>
</div>
<ul>
<li>A <strong>perfect classifier</strong> would achieve a TPR of 1 and an FPR of 0, corresponding to the top-left corner of the plot.</li>
<li>A <strong>random classifier</strong> (e.g., flipping a coin) would produce a diagonal line from (0,0) to (1,1). Any useful classifier must perform above this line.</li>
<li>The closer the curve is to the top-left corner, the better the classifier.</li>
</ul>
<div id="fig-roc-curves-comparison" class="quarto-float quarto-figure quarto-figure-left anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-roc-curves-comparison-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/compare-classifiers-ROC.svg" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-roc-curves-comparison-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.3: ROC curves for the classifiers from <a href="#fig-dataset04" class="quarto-xref">Figure&nbsp;<span>4.1</span></a>.
</figcaption>
</figure>
</div>
<section id="area-under-the-curve-auc" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="area-under-the-curve-auc"><span class="header-section-number">4.2.1</span> Area Under the Curve (AUC)</h3>
<p>While the ROC curve provides a comprehensive view, it is often convenient to summarise it with a single number: the <strong>Area Under the Curve (AUC)</strong>.</p>
<p><span class="math display">
\mathrm{AUC} = \int_0^1 \mathrm{TPR}(\mathrm{FPR}) \, d\mathrm{FPR}
</span></p>
<p>The AUC can be interpreted as the probability that the classifier will rank a randomly chosen positive instance higher than a randomly chosen negative one. A perfect classifier has an AUC of 1.0, while a random classifier has an AUC of 0.5.</p>
</section>
<section id="average-precision" class="level3" data-number="4.2.2">
<h3 data-number="4.2.2" class="anchored" data-anchor-id="average-precision"><span class="header-section-number">4.2.2</span> Average Precision</h3>
<p>Similarly, one can plot a <strong>Precision-Recall curve</strong> and compute the area under it, which is known as the <strong>Average Precision (AP)</strong>. This metric is particularly informative for highly imbalanced datasets where the number of negatives far outweighs the number of positives.</p>
<p>It is implemented slightly differently from the ROC-AUC: <span class="math display">
\mathrm{AP} = \sum_{i=1}^n \mathrm{Precision}_i \times \left(\mathrm{Recall}_i-\mathrm{Recall}_{i-1}\right)
</span> where <span class="math inline">\mathrm{Recall}_i</span> and <span class="math inline">\mathrm{Precision}_i</span> are the precision and recall values taken at <span class="math inline">n</span> different thresholds <span class="math inline">T_i</span> values.</p>
</section>
</section>
<section id="metrics-for-multiclass-classification" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="metrics-for-multiclass-classification"><span class="header-section-number">4.3</span> Metrics for Multiclass Classification</h2>
<p>When we have more than two classes, the concepts of precision and recall do not apply directly. The confusion matrix becomes a <span class="math inline">K \times K</span> table for a <span class="math inline">K</span>-class problem.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: center;">Actual: 0</th>
<th style="text-align: center;">Actual: 1</th>
<th style="text-align: center;">Actual: 2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Predicted: 0</td>
<td style="text-align: center;">102</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">5</td>
</tr>
<tr class="even">
<td style="text-align: left;">Predicted: 1</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">89</td>
<td style="text-align: center;">12</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Predicted: 2</td>
<td style="text-align: center;">7</td>
<td style="text-align: center;">11</td>
<td style="text-align: center;">120</td>
</tr>
</tbody>
</table>
<p>There are <span class="math inline">K-1</span> possible ways of miss-classifying each class. Thus there are <span class="math inline">(K-1) \times K</span> types of errors in total.</p>
<p>The most common way to adapt binary metrics to the multiclass setting is to use averaging strategies. For each class <span class="math inline">k</span>, we can compute its own set of metrics by considering it as the “positive” class and all other classes as the “negative” class (a one-vs-rest approach). Then, we can average these per-class metrics.</p>
<ul>
<li><p><strong>Macro-averaging</strong>: Compute the metric independently for each class and then take the unweighted average. This treats all classes equally, regardless of their size. <span class="math display">
\mathrm{MacroPrecision} = \frac{1}{K} \sum_{k=1}^K \mathrm{Precision}_k
</span></p></li>
<li><p><strong>Micro-averaging</strong>: Aggregate the counts of TP, FP, and FN for all classes first, and then compute the metric from these aggregated counts. This gives equal weight to each individual prediction, so larger classes have more influence. <span class="math display">
\mathrm{MicroPrecision} = \frac{\sum \mathrm{TP}_k}{\sum \mathrm{TP}_k + \sum \mathrm{FP}_k}
</span></p></li>
</ul>
<div id="callout-example-micromacrometrics" class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Example
</div>
</div>
<div class="callout-body-container callout-body">
<p>Given <code>y_true = [0, 1, 2, 0, 1, 2, 2]</code> and <code>y_pred = [0, 2, 1, 0, 0, 1, 0]</code></p>
<p>we have <span class="math inline">\mathrm{TP}_0 = 2</span>, <span class="math inline">\mathrm{TP}_1 = 0</span>, <span class="math inline">\mathrm{TP}_2 = 0</span>, <span class="math inline">\mathrm{FP}_0 = 2</span>, <span class="math inline">\mathrm{FP}_1 = 2</span>, <span class="math inline">\mathrm{FP}_2 = 1</span></p>
<p><span class="math display">
\mathrm{MicroPrecision} = \frac{2 + 0 + 0}{ (2+0+0) + (1 + 2 + 1)} = 0.286
</span></p>
<p><span class="math display">
\mathrm{MacroPrecision} = \frac{1}{3} \left( \frac{2}{2+2} +  \frac{0}{0  +
    2} +
  \frac{0}{0 + 1} \right) = 0.167
</span></p>
</div>
</div>
<p>A popular macro-averaged metric is the <strong>mean Average Precision (mAP)</strong>, which is the average of the Average Precision (AP) scores across all classes:</p>
<p><span class="math display">
\mathrm{mAP} = \frac{1}{K} \sum_{k=1}^K \mathrm{AP}_k
</span></p>
</section>
<section id="the-three-essential-datasets-training-validation-and-testing" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="the-three-essential-datasets-training-validation-and-testing"><span class="header-section-number">4.4</span> The Three Essential Datasets: Training, Validation, and Testing</h2>
<p>Now that we have our metrics, we must be careful about <em>what data</em> we use to compute them. A robust evaluation workflow requires splitting our data into three distinct sets:</p>
<ol type="1">
<li><p><strong>Training Set</strong>: This is the data the model learns from. The model’s parameters (e.g., the weights in logistic regression) are optimised to minimise the loss on this set.</p></li>
<li><p><strong>Validation (or Development) Set</strong>: This set is used to tune the model’s <strong>hyperparameters</strong>—the configuration settings that are not learned directly, such as the learning rate, the value of <span class="math inline">k</span> in <span class="math inline">k</span>-NN, or the strength of regularisation. We choose the hyperparameters that yield the best performance on the validation set.</p></li>
<li><p><strong>Test Set</strong>: This set is held out until the very end. It is used only once to provide a final, unbiased estimate of the chosen model’s performance on unseen data. <strong>You must never tune your model based on its performance on the test set.</strong> Doing so would be a form of data leakage, and your final performance metric would be an overly optimistic and invalid estimate of how the model will perform in the real world.</p></li>
</ol>
<p>This separation is crucial to avoid overfitting. A model can easily memorise the training set, so good performance there means little. By tuning on a separate validation set, we get a more realistic estimate of generalisation. As tuning is essentially a form of training, performance on the dev set is also tainted. The final test set provides the ultimate, honest assessment.</p>
<p>How large do the dev/test sets need to be?</p>
<ul>
<li><p><strong>Training sets</strong>: as large as you can afford.</p></li>
<li><p><strong>Validation/Dev sets</strong> with sizes from 1,000 to 10,000 examples are common. With 100 examples, you will have a good chance of detecting an improvement of 5%. With 10,000 examples, you will have a good chance of detecting an improvement of 0.1%. The size of that dataset should be at least as large as what is required by your targetted <a href="https://en.wikipedia.org/wiki/Confidence_interval">confidence interval</a>.</p></li>
<li><p><strong>Test sets</strong> should be large enough to give high confidence in the overall performance of your system. One popular heuristic had been to use 30% of your data for your test set. This is makes sense when you have, say, 100 to 10,000 examples but maybe less so when you have billion of training examples. Basically, think that you want to catch the all possible edge cases of your system.</p></li>
</ul>
<p>Important: the test and dev sets should contain examples of what you ultimately want to perform well on, rather than whatever data you happen to have for training.</p>
</section>
<section id="takeaways" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="takeaways"><span class="header-section-number">4.5</span> Takeaways</h2>
<ul>
<li><p>Before starting any machine learning project, your first steps should be to define your <strong>evaluation metrics</strong> and carefully create your <strong>training, validation, and test sets</strong>.</p></li>
<li><p>For binary classification, always use a combination of metrics. <strong>Accuracy</strong> alone can be misleading. <strong>Precision</strong>, <strong>recall</strong>, and the <strong>F1 score</strong> provide a more complete picture.</p></li>
<li><p>The <strong>ROC curve</strong> and its corresponding <strong>AUC</strong> score are excellent tools for evaluating and comparing models across all possible thresholds.</p></li>
<li><p>For multiclass problems, use <strong>macro-</strong> or <strong>micro-averaging</strong> to adapt binary metrics. The <strong>confusion matrix</strong> remains a vital tool for detailed error analysis.</p></li>
<li><p>Rigorously separating your data into training, validation, and test sets is non-negotiable for building models that generalise well to new, unseen data.</p></li>
</ul>
</section>
<section id="exercises" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="exercises">Exercises</h2>
<div id="exr-04-confusion-matrix-analysis" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.1</strong></span> Consider a binary classifier with the following confusion matrix:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: center;">Actual: 0</th>
<th style="text-align: center;">Actual: 1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Predicted: 0</td>
<td style="text-align: center;">TN=16</td>
<td style="text-align: center;">FN=4</td>
</tr>
<tr class="even">
<td style="text-align: left;">Predicted: 1</td>
<td style="text-align: center;">FP=10</td>
<td style="text-align: center;">TP=70</td>
</tr>
</tbody>
</table>
<p>Compute the accuracy and comment on the performance of the classifier.</p>
</div>
<div id="exr-04-multiclass" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.2</strong></span> Consider a multiclass classifier which produce the following results</p>
<pre><code>y_true = [0, 0, 1, 2, 2, 2, 1, 1, 0]
y_pred = [1, 0, 1, 2, 1, 0, 1, 2, 0]</code></pre>
<p>compute the confusion matrix, the accuracy, the micro precision and the macro precision.</p>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./chapter-03-classic-classifiers.html" class="pagination-link" aria-label="A Tour of Classic Classifiers">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">A Tour of Classic Classifiers</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./chapter-05-deep-feedforward-networks.html" class="pagination-link" aria-label="Feedforward Neural Networks">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Feedforward Neural Networks</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>Copyright 2025, François Pitié</p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>